<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WinGo 3M Hacker System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #0f0;
            min-height: 100vh;
            padding: 20px;
        }

        @keyframes glow { 
            0%, 100% { text-shadow: 0 0 10px #0f0, 0 0 20px #0f0; }
            50% { text-shadow: 0 0 20px #0f0, 0 0 40px #0f0; }
        }

        @keyframes fade { from { opacity: 0; } to { opacity: 1; } }

        .container { max-width: 1200px; margin: 0 auto; }

        .header {
            background: rgba(0, 50, 0, 0.8);
            border: 2px solid #0f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            animation: fade 1s;
        }

        .title {
            font-size: 32px;
            animation: glow 2s infinite;
            margin-bottom: 10px;
        }

        .subtitle { font-size: 14px; color: #0c0; }

        .btn {
            background: transparent;
            border: 2px solid #0f0;
            color: #0f0;
            padding: 12px 25px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            margin: 15px auto;
            display: block;
            transition: 0.3s;
        }

        .btn:hover {
            background: #0f0;
            color: #000;
            box-shadow: 0 0 20px #0f0;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(0, 30, 0, 0.8);
            border: 2px solid #0f0;
            border-radius: 8px;
            padding: 20px;
            animation: fade 1s;
        }

        .card:hover {
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            transform: translateY(-3px);
            transition: 0.3s;
        }

        .card-title {
            font-size: 16px;
            margin-bottom: 12px;
            color: #0f0;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }

        .table-container {
            background: rgba(0, 30, 0, 0.9);
            border: 2px solid #0f0;
            border-radius: 10px;
            overflow: hidden;
            animation: fade 1.5s;
        }

        .table-header {
            background: rgba(0, 255, 0, 0.1);
            padding: 15px;
            font-size: 20px;
            border-bottom: 2px solid #0f0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }

        th { 
            background: rgba(0, 255, 0, 0.05);
            font-weight: bold;
        }

        tr:hover { background: rgba(0, 255, 0, 0.05); }

        .num-box {
            display: inline-block;
            width: 45px;
            height: 45px;
            line-height: 45px;
            text-align: center;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
        }

        .green { background: #0f0; color: #000; box-shadow: 0 0 10px #0f0; }
        .red { background: #f00; color: #fff; box-shadow: 0 0 10px #f00; }
        .violet { background: linear-gradient(135deg, #f00, #f0f); color: #fff; }

        .badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: bold;
            border: 1px solid;
        }

        .big { background: rgba(255, 165, 0, 0.2); border-color: #fa0; color: #fa0; }
        .small { background: rgba(0, 150, 255, 0.2); border-color: #09f; color: #09f; }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
            animation: glow 1s infinite;
        }

        .error {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #f00;
            color: #f00;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .success {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #0f0;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .footer {
            text-align: center;
            padding: 15px;
            color: #0c0;
            margin-top: 20px;
        }

        .top-nums {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 10px;
            text-align: center;
        }

        .top-num div:first-child {
            width: 35px;
            height: 35px;
            line-height: 35px;
            border-radius: 6px;
            font-weight: bold;
            margin: 0 auto 4px;
        }

        .top-num div:last-child { font-size: 11px; color: #0c0; }

        @media (max-width: 768px) {
            .title { font-size: 24px; }
            .stats { grid-template-columns: 1fr; }
            table { font-size: 12px; }
            th, td { padding: 8px 4px; }
            .num-box { width: 35px; height: 35px; line-height: 35px; font-size: 16px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">‚ö° WINGO 3M HACKER SYSTEM ‚ö°</div>
            <div class="subtitle">/// REAL-TIME PREDICTION ANALYTICS ///</div>
        </div>

        <button class="btn" onclick="loadData()">üîÑ REFRESH DATA</button>

        <div id="error"></div>

        <div class="stats" id="stats" style="display:none;">
            <div class="card">
                <div class="card-title">üìä COLOR STATS</div>
                <div class="stat-row"><span style="color:#0f0">‚óè Green</span><span id="green">0</span></div>
                <div class="stat-row"><span style="color:#f00">‚óè Red</span><span id="red">0</span></div>
                <div class="stat-row"><span style="color:#f0f">‚óè Violet</span><span id="violet">0</span></div>
            </div>

            <div class="card">
                <div class="card-title">üìà SIZE STATS</div>
                <div class="stat-row"><span style="color:#fa0">Big (5-9)</span><span id="big">0</span></div>
                <div class="stat-row"><span style="color:#09f">Small (0-4)</span><span id="small">0</span></div>
            </div>

            <div class="card">
                <div class="card-title">üéØ TOP 5 NUMBERS</div>
                <div class="top-nums" id="topNums"></div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-header">‚è±Ô∏è LAST 15 RESULTS</div>
            <div id="content">
                <div class="loading">‚è≥ LOADING...</div>
            </div>
        </div>

        <div class="footer">
            <div>AUTO-UPDATE: 30 SEC | LAST: <span id="time"></span></div>
        </div>
    </div>

    <script>
        let data = [];
        let isRealData = false;

        function getColorClass(n) {
            if (n === 0 || n === 5) return 'violet';
            return [1,3,7,9].includes(n) ? 'green' : 'red';
        }

        function getColorName(n) {
            if (n === 0 || n === 5) return 'Red+Violet';
            return [1,3,7,9].includes(n) ? 'Green' : 'Red';
        }

        async function loadData() {
            const err = document.getElementById('error');
            const content = document.getElementById('content');
            const stats = document.getElementById('stats');
            
            err.innerHTML = '';
            content.innerHTML = '<div class="loading">‚è≥ LOADING...</div>';

            try {
                // ‡¶¨‡¶ø‡¶ï‡¶≤‡ßç‡¶™ API URLs ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá
                const urls = [
                    `https://draw.ar-lottery01.com/WinGo/WinGo_3M.json?ts=${Date.now()}`,
                    `https://api.ar-lottery01.com/api/Lottery/GetNoaverageEmerdList?typeId=2&language=en&random=${Math.random()*1e9|0}&signature=198C060C3EFA83B1030719D2ECA2295F&timestamp=${Date.now()}`,
                    `https://api.ar-lottery01.com/api/Lottery/GetHistoryIssuePage?gameCode=WinGo_3M&pageNo=1&pageSize=15&language=en&random=${Math.random()*1e9|0}&signature=198C060C3EFA83B1030719D2ECA2295F&timestamp=${Date.now()}`
                ];

                let fetchedData = [];
                let apiSuccess = false;

                for (let url of urls) {
                    try {
                        const response = await fetch(url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json',
                            },
                            mode: 'cors'
                        });

                        if (response.ok) {
                            const jsonData = await response.json();
                            
                            // ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® API response format handle ‡¶ï‡¶∞‡¶æ
                            if (Array.isArray(jsonData)) {
                                fetchedData = [...fetchedData, ...jsonData];
                            } else if (jsonData?.data?.list) {
                                fetchedData = [...fetchedData, ...jsonData.data.list];
                            } else if (jsonData?.data) {
                                if (Array.isArray(jsonData.data)) {
                                    fetchedData = [...fetchedData, ...jsonData.data];
                                }
                            }

                            if (fetchedData.length >= 15) {
                                apiSuccess = true;
                                break;
                            }
                        }
                    } catch (e) {
                        console.log(`Failed to fetch from ${url}:`, e.message);
                        continue;
                    }
                }

                data = fetchedData.slice(0, 15);

                if (data.length && apiSuccess) {
                    isRealData = true;
                    showTable();
                    calcStats();
                    stats.style.display = 'grid';
                    err.innerHTML = '<div class="success">‚úÖ API ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</div>';
                    setTimeout(() => { err.innerHTML = ''; }, 3000);
                } else {
                    // ‡¶Ø‡¶¶‡¶ø API ‡¶ï‡¶æ‡¶ú ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶°‡ßá‡¶Æ‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                    isRealData = false;
                    generateDemoData();
                    err.innerHTML = '<div class="error">‚ö†Ô∏è API ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶∏‡¶õ‡ßá ‡¶®‡¶æ‡•§ ‡¶°‡ßá‡¶Æ‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§<br><small>‡¶∏‡¶Æ‡ßç‡¶≠‡¶æ‡¶¨‡ßç‡¶Ø ‡¶ï‡¶æ‡¶∞‡¶£: CORS Policy, Network Error, ‡¶¨‡¶æ API Down</small></div>';
                }

                document.getElementById('time').textContent = new Date().toLocaleTimeString('bn-BD');

            } catch (e) {
                err.innerHTML = `<div class="error">‚ö†Ô∏è ERROR: ${e.message}<br><small>API ‡¶è ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶ï‡ßç‡¶∑‡¶£ ‡¶™‡¶∞ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</small></div>`;
                console.error('Full error:', e);
                isRealData = false;
                generateDemoData();
            }
        }

        function generateDemoData() {
            // ‡¶°‡ßá‡¶Æ‡ßã ‡¶°‡ßá‡¶ü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ (‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡¶∏‡¶Æ‡ßç‡¶Æ‡¶§)
            data = [];
            const now = Date.now();
            for (let i = 0; i < 15; i++) {
                const num = Math.floor(Math.random() * 10);
                const timestamp = now - (i * 180000); // ‡¶™‡ßç‡¶∞‡¶§‡¶ø 3 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü
                const date = new Date(timestamp);
                const period = `${date.getFullYear()}${String(date.getMonth()+1).padStart(2,'0')}${String(date.getDate()).padStart(2,'0')}${String(Math.floor(timestamp/1000)).slice(-4)}`;
                
                data.push({
                    number: num,
                    issue: period,
                    drawResult: num,
                    issueNo: period
                });
            }
            showTable();
            calcStats();
            document.getElementById('stats').style.display = 'grid';
        }

        function showTable() {
            let html = '<table><thead><tr><th>#</th><th>PERIOD</th><th style="text-align:center">NUMBER</th><th style="text-align:center">COLOR</th><th style="text-align:center">SIZE</th></tr></thead><tbody>';

            data.forEach((item, i) => {
                const num = parseInt(item.number || item.drawResult);
                const period = item.issue || item.issueNo || 'N/A';
                const big = num >= 5;
                const cc = getColorClass(num);
                const cn = getColorName(num);

                html += `<tr>
                    <td><b>#${i+1}</b></td>
                    <td>${period}</td>
                    <td style="text-align:center"><div class="num-box ${cc}">${num}</div></td>
                    <td style="text-align:center;color:${num===0||num===5?'#f0f':[1,3,7,9].includes(num)?'#0f0':'#f00'}">${cn}</td>
                    <td style="text-align:center"><span class="badge ${big?'big':'small'}">${big?'BIG':'SMALL'}</span></td>
                </tr>`;
            });

            html += '</tbody></table>';
            
            if (!isRealData) {
                html += '<div style="text-align:center;padding:15px;color:#fa0;font-size:12px;">‚ö†Ô∏è ‡¶è‡¶ü‡¶ø ‡¶°‡ßá‡¶Æ‡ßã ‡¶°‡ßá‡¶ü‡¶æ (API ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡ßá ‡¶®‡¶æ)</div>';
            }
            
            document.getElementById('content').innerHTML = html;
        }

        function calcStats() {
            const color = {green:0, red:0, violet:0};
            const size = {big:0, small:0};
            const nums = {};

            data.forEach(item => {
                const n = parseInt(item.number || item.drawResult);
                if (isNaN(n)) return;

                nums[n] = (nums[n] || 0) + 1;

                if (n === 0) { color.red++; color.violet++; }
                else if (n === 5) { color.green++; color.violet++; }
                else if ([1,3,7,9].includes(n)) color.green++;
                else if ([2,4,6,8].includes(n)) color.red++;

                if (n >= 5) size.big++; else size.small++;
            });

            document.getElementById('green').textContent = color.green;
            document.getElementById('red').textContent = color.red;
            document.getElementById('violet').textContent = color.violet;
            document.getElementById('big').textContent = size.big;
            document.getElementById('small').textContent = size.small;

            const top = Object.entries(nums).sort((a,b) => b[1]-a[1]).slice(0,5);
            let topHtml = '';
            top.forEach(([n, c]) => {
                topHtml += `<div class="top-num"><div class="${getColorClass(parseInt(n))}">${n}</div><div>${c}x</div></div>`;
            });
            document.getElementById('topNums').innerHTML = topHtml;
        }

        // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶≤‡ßã‡¶°
        loadData();
        
        // ‡¶™‡ßç‡¶∞‡¶§‡¶ø 30 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        setInterval(loadData, 30000);
    </script>
</body>
</html>
