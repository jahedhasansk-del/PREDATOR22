<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>WinGo 3M Live History + Prediction</title>
<style>
  body {
    background:#0b0b0b;
    color:#00ffcc;
    font-family:monospace;
    padding:12px;
  }
  h1 { color:#ffcc00; text-align:center; margin-bottom:10px; }
  table {
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
  }
  th,td {
    border:1px solid #00ffcc33;
    padding:6px;
    text-align:center;
    font-size:13px;
  }
  th { background:#111; }
  tr:nth-child(even){background:#161616;}
  .pred{color:#ff66cc;font-weight:bold;}
  .ok{color:#00ff00;}
  .wrong{color:#ff4444;}
</style>
</head>
<body>

<h1>WinGo 3M Live Prediction</h1>
<div id="prediction" class="pred">Loading...</div>

<table>
  <thead>
    <tr>
      <th>Round</th>
      <th>Number</th>
      <th>Result</th>
      <th>Prediction</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody id="history"><tr><td colspan="5">Loading...</td></tr></tbody>
</table>

<script>
const API_URL = "https://draw.ar-lottery01.com/WinGo/WinGo_3M/GetHistoryIssuePage.json";
let allHistory = []; // সব হিস্ট্রি রাখার জন্য
let lastPrediction = null;

// localStorage থেকে আগের সেভড ডাটা লোড করো
if(localStorage.getItem("wingo_history")){
  allHistory = JSON.parse(localStorage.getItem("wingo_history"));
  renderTable();
}

// প্রতি আপডেটে নতুন 10 রাউন্ড এনে merge করো
async function fetchData(){
  try{
    const res = await fetch(`${API_URL}?ts=${Date.now()}`);
    const data = await res.json();
    const list = data.data;

    if(!Array.isArray(list)) return;

    // নতুন রাউন্ড গুলো অ্যাড করো
    list.forEach(item=>{
      if(!allHistory.find(h=>h.issue===item.issue)){
        const result = Number(item.number)>=5 ? "BIG" : "SMALL";
        allHistory.unshift({
          issue:item.issue,
          number:Number(item.number),
          result:result
        });
      }
    });

    // সর্বোচ্চ ২০০ টা রেকর্ড রাখো
    if(allHistory.length>200) allHistory = allHistory.slice(0,200);

    // localStorage এ সেভ করো
    localStorage.setItem("wingo_history",JSON.stringify(allHistory));

    renderTable();
    makePrediction();

  }catch(err){
    console.error("Fetch error:",err);
  }
}

// প্রেডিকশন লজিক (Momentum / Reversal)
function makePrediction(){
  if(allHistory.length<2) return;
  const [last,prev] = allHistory;
  let prediction;
  if(last.result===prev.result){
    prediction = last.result==="BIG"?"SMALL":"BIG"; // Reversal
  }else{
    prediction = last.result; // Momentum
  }
  lastPrediction = prediction;
  document.getElementById("prediction").innerHTML =
    `Next Prediction ➜ <b>${prediction}</b>`;
}

// টেবিল রেন্ডার
function renderTable(){
  const tbody = document.getElementById("history");
  tbody.innerHTML = "";
  allHistory.forEach((h,i)=>{
    const prev = allHistory[i+1];
    const predicted = prev?prev.prediction:lastPrediction;
    const isCorrect = predicted && predicted===h.result;
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${h.issue}</td>
      <td>${h.number}</td>
      <td>${h.result}</td>
      <td>${predicted||"-"}</td>
      <td>${i===0?"LIVE":(isCorrect?"<span class='ok'>✅</span>":"<span class='wrong'>❌</span>")}</td>
    `;
    tbody.appendChild(tr);
  });
}

// প্রতি ৩ মিনিট ২ সেকেন্ড পর আপডেট
setInterval(fetchData,182000);
fetchData();
</script>
</body>
</html>
